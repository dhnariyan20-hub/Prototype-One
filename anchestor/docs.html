<!DOCTYPE html>
<html lang="en" class="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anchestor Docs | xemonbae01</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/feather-icons"></script>
<style>
    body { font-family: 'Inter', sans-serif; background: linear-gradient(to bottom, #111827, #1f2937); color: #f9fafb; }
    pre { scrollbar-width: thin; scrollbar-color: #6366f1 #1f2937; }
    pre::-webkit-scrollbar { height: 8px; }
    pre::-webkit-scrollbar-thumb { background-color: #6366f1; border-radius: 4px; }
    pre::-webkit-scrollbar-track { background-color: #1f2937; border-radius: 4px; }
    .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(20px); border-radius: 20px; border: 1px solid rgba(255,255,255,0.1); }
    .text-glow { text-shadow: 0 0 8px rgba(255,255,255,0.1); }
    .transition-all-custom { transition: all 0.3s ease; }
    .menu-open { display: block !important; }
</style>
</head>
<body>

<custom-navbar></custom-navbar>

<main class="container mx-auto px-6 py-16">
    <h1 class="text-5xl font-extrabold mb-4 text-primary-500 text-center text-glow">API Documentation</h1>
    <p class="mb-12 text-center text-gray-300 text-lg text-glow">All available APIs for Anchestor. Click “Try it” to test each API.</p>
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="api-cards"></div>
</main>

<custom-footer></custom-footer>

<script>
class CustomNavbar extends HTMLElement {
    connectedCallback() {
        this.attachShadow({ mode: 'open' });
        this.shadowRoot.innerHTML = `
            <nav class="sticky top-0 z-50 bg-white/10 backdrop-blur-md border-b border-gray-800">
                <div class="container mx-auto px-4">
                    <div class="flex justify-between items-center py-4">
                        <a href="/" class="text-xl font-bold text-primary-500 flex items-center">
                            <i data-feather="cpu" class="mr-2"></i> Anchestor
                        </a>
                        <div class="hidden md:flex space-x-8 text-gray-300">
                            <a href="/" class="hover:text-primary-500">Home</a>
                            <a href="/docs" class="hover:text-primary-500">Docs</a>
                            <a href="https://github.com/xemonbae01" target="_blank" class="hover:text-primary-500">GitHub</a>
                        </div>
                        <div class="md:hidden relative">
                            <button id="menu-btn" class="focus:outline-none">
                                <i data-feather="more-vertical" class="text-gray-300 w-6 h-6"></i>
                            </button>
                            <div id="mobile-menu" class="absolute right-0 mt-2 w-40 bg-gray-800 rounded-lg shadow-lg hidden flex-col py-2 z-50">
                                <a href="/" class="px-4 py-2 text-gray-200 hover:bg-gray-700 rounded">Home</a>
                                <a href="/docs" class="px-4 py-2 text-gray-200 hover:bg-gray-700 rounded">Docs</a>
                                <a href="https://github.com/xemonbae01" target="_blank" class="px-4 py-2 text-gray-200 hover:bg-gray-700 rounded">GitHub</a>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        `;
        feather.replace();

        const menuBtn = this.shadowRoot.getElementById('menu-btn');
        const mobileMenu = this.shadowRoot.getElementById('mobile-menu');
        menuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
        document.addEventListener('click', (e) => {
            if (!menuBtn.contains(e.target) && !mobileMenu.contains(e.target)) {
                mobileMenu.classList.add('hidden');
            }
        });
    }
}

class CustomFooter extends HTMLElement {
    connectedCallback() {
        this.innerHTML = `
            <footer class="text-center py-6 text-gray-400 text-sm">
                &copy; 2025 xemonbae01 | Anchestor
            </footer>
        `;
    }
}

customElements.define('custom-navbar', CustomNavbar);
customElements.define('custom-footer', CustomFooter);

async function loadAPIs() {
    try {
        const res = await fetch('/api/info');
        const apis = await res.json();
        const apiCardsContainer = document.getElementById('api-cards');

        apis.forEach(api => {
            const card = document.createElement("div");
            card.className = "glass p-6 rounded-3xl shadow-xl hover:shadow-2xl transform hover:-translate-y-2 transition-all-custom flex flex-col justify-between";
            card.innerHTML = `
                <h3 class="text-xl font-bold mb-2 text-primary-500 text-glow">${api.name}</h3>
                <p class="text-gray-200 mb-4 text-glow">${api.description}</p>
                <p class="mb-4">
                    <span class="px-2 py-1 bg-green-600 text-white text-xs font-medium rounded">${api.method}</span>
                    <code class="bg-gray-900 text-gray-100 px-2 py-1 rounded text-sm">${api.endpoint}${api.example}</code>
                </p>
                <button class="mt-auto px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-all font-semibold" onclick="tryAPI('${api.endpoint}', '${api.example}', '${api.name}')">Try it</button>
                <pre class="mt-4 text-sm bg-gray-900 p-3 rounded overflow-x-auto" id="response-${api.name}">Response will appear here...</pre>
            `;
            apiCardsContainer.appendChild(card);
        });
    } catch (err) {
        console.error('Failed to load APIs:', err);
    }
}

async function tryAPI(endpoint, query, name) {
    const responseEl = document.getElementById(`response-${name}`);
    try {
        const res = await fetch(`${endpoint}${query}`);
        if (!res.ok) throw new Error(`Status ${res.status}`);
        const blob = await res.blob();
        if (res.headers.get("Content-Type").includes("image")) {
            const url = URL.createObjectURL(blob);
            responseEl.innerHTML = `<img src="${url}" alt="Generated Image" class="rounded-lg max-w-full" />`;
        } else {
            const text = await res.text();
            responseEl.textContent = text;
        }
    } catch (err) {
        responseEl.textContent = `Error: ${err.message}`;
    }
}

loadAPIs();
</script>

</body>
</html>
